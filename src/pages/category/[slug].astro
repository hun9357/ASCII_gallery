---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AsciiCard from '../../components/AsciiCard.astro';
import SearchBar from '../../components/SearchBar.astro';
import CategoryFilter from '../../components/CategoryFilter.astro';
import Breadcrumb from '../../components/Breadcrumb.astro';
import asciiArts from '../../data/ascii-arts.json';
import categories from '../../data/categories.json';

export async function getStaticPaths() {
  return categories.categories.map((cat) => ({
    params: { slug: cat.slug },
    props: {
      category: cat,
      arts: asciiArts.arts.filter((art) => art.category === cat.slug),
    },
  }));
}

const { category, arts } = Astro.props;
const title = `${category.seoTitle} | ASCII Art Gallery`;
const description = category.seoDescription;
---

<BaseLayout title={title} description={description}>
  <!-- Breadcrumb -->
  <Breadcrumb
    items={[
      { name: 'Home', url: '/' },
      { name: category.name }
    ]}
  />

  <!-- Category Header -->
  <section class="text-center mb-10">
    <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4">
      <span class="mr-2">{category.icon}</span>
      {category.name} ASCII Art
    </h1>
    <p class="text-lg text-gray-600 dark:text-gray-400 mb-6">{category.description}</p>
    <p class="text-sm text-gray-500 dark:text-gray-400">{arts.length} items</p>

    <div class="max-w-xl mx-auto mt-6">
      <SearchBar placeholder={`Search ${category.name.toLowerCase()}...`} />
    </div>
  </section>

  <!-- Category Filter -->
  <CategoryFilter currentCategory={category.slug} />

  <!-- Ad Slot -->
  <div class="bg-gray-100 dark:bg-gray-800 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 mb-8 text-center text-gray-400 dark:text-gray-500 text-sm">
    Ad Space (728x90)
  </div>

  <!-- ASCII Art Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {arts.map((art) => (
      <div data-searchable={`${art.title} ${art.category} ${art.tags.join(' ')}`}>
        <AsciiCard
          id={art.id}
          title={art.title}
          content={art.content}
          category={art.category}
          tags={art.tags}
        />
      </div>
    ))}
  </div>

  <!-- SEO Content -->
  <section class="mt-12 prose prose-gray dark:prose-invert max-w-none">
    <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">About {category.name} ASCII Art</h2>
    <p class="text-gray-600 dark:text-gray-400 mb-4">
      Browse our collection of {category.name.toLowerCase()} ASCII art. All designs are free to copy and paste
      for use on Discord, social media, messaging apps, and more. Simply click the "Copy" button and paste
      wherever you want!
    </p>

    <h2 class="text-2xl font-bold text-gray-900 mb-4 mt-8">How to Use</h2>
    <ol class="list-decimal list-inside text-gray-600 space-y-2">
      <li>Find the {category.name.toLowerCase()} ASCII art you like</li>
      <li>Click the "Copy" button</li>
      <li>Paste it in Discord, Twitter, messages, or anywhere else</li>
    </ol>
  </section>
</BaseLayout>
